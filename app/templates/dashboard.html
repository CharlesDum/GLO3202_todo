{% extends 'base.html' %}

{% block content %}
    <!-- Formulaire pour créer une nouvelle liste -->
    <h2>Créer une nouvelle liste</h2>
    <form action="{{ url_for('create_list') }}" method="POST">
    <label for="listName">Nom de la liste :</label>
    <input type="text" id="listName" name="name" placeholder="Nom de la liste" required>
    <button type="submit">Créer</button>
    </form>

    <!-- Afficher les listes existantes -->
    <h2>Vos listes</h2>
    <ul>
        {% for todo_list in lists %}
            <li>
                {{ todo_list.name }}
                <form action="{{ url_for('handle_list', list_id=todo_list._id) }}" method="POST" style="display: inline;">
                    <input type="text" name="name" placeholder="Nouveau nom" required>
                    <input type="hidden", name="action" value="update">
                    <button type="submit">Modifier</button>
                </form>
                <form action="{{ url_for('handle_list', list_id=todo_list._id) }}" method="POST" style="display: inline;">
                    <input type="hidden" name="action" value="delete">
                    <button type="submit" onclick="return confirm('Voulez-vous vraiment supprimer cette liste ?');">Supprimer</button>
                </form>

                <!-- Tâches associées -->
                <h4>Tâches</h4>
                <ul>
                    {% for task in todo_list.tasks %}
                    <li>
                        <form action="{{ url_for('handle_task', list_id=todo_list._id, task_id=task._id) }}" method="POST" style="display: inline">
                            <input type="text" name="description" value="{{ task.description }}">
                            <input type="checkbox" name="completed" {% if task.completed %}checked{% endif %}>
                            <input type="hidden" name="action" value="update">
                            <button type="submit">Mettre à jour</button>
                        </form>
                        <form action="{{ url_for('handle_task', list_id=todo_list._id, task_id=task._id) }}" method="POST" style="display: inline;">
                            <input type="hidden" name="action" value="delete">
                            <button type="submit" onclick="return confirm('Voulez-vous vraiment supprimer cette tâche ?');">Supprimer</button>
                        </form>
                    </li>
                    {% endfor %}
                </ul>

                <!-- Ajouter une nouvelle tâche -->
                <form action="{{ url_for('add_task', list_id=todo_list._id) }}" method="POST">
                    <input type="text" name="description" placeholder="Description de la tâche" required>
                    <button type="submit">Ajouter une tâche</button>
                </form>
            </li>
        {% endfor %}
    </ul>
{% endblock %}